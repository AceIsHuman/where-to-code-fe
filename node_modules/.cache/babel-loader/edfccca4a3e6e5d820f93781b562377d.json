{"ast":null,"code":"import _defineProperty from \"/Users/ajohnson/Desktop/lambda/where-to-code-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"/Users/ajohnson/Desktop/lambda/where-to-code-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/ajohnson/Desktop/lambda/where-to-code-fe/src/components/Review/ReviewPanel.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _templateObject4() {\n  const data = _taggedTemplateLiteral([\"\\n  font-size: 20px;\\n  color: white;\\n  font-weight: 500;\\n  letter-spacing: 3px;\\n\"]);\n\n  _templateObject4 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  const data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  padding: 15px;\\n  margin: 5px 0 5px 0;\\n  font-weight: bold;\\n  font-size: 14px;\\n  box-shadow: 10px 6px 10px 6px rgba(0, 0, 0, 0.2);\\n  .buttonContainer {\\n    display: flex;\\n    justify-content: center;\\n  }\\n  border-radius: 10px 10px 10px 10px;\\n  background-color: white;\\n  const buttonStyle = {\\n    margin: \\\"10px 10px 10px 10px\\\";\\n  }\\n\"]);\n\n  _templateObject3 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  const data = _taggedTemplateLiteral([\"\\n  text-align: center;\\n  font-size: 20px;\\n  font-weight: bold;\\n  color: #fbd702;\\n  width: 100%;\\n  margin-bottom: 15px;\\n\"]);\n\n  _templateObject2 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  padding: 10px;\\n  font-size: 12px;\\n  max-height: 550px;\\n\"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\n// IMPORTS\nimport React, { Component } from \"react\";\nimport styled from \"styled-components\";\nimport axios from \"axios\"; //import { distanceTo } from \"geolocation-utils\";\n\nimport axiosWithAuth from \"../../Helpers/axiosWithAuth\"; // COMPONENTS\n\nimport NetworkModal from \"../NetworkSpeed/networkModal\";\nimport NetworkSpeed from \"../NetworkSpeed/NetworkSpeed\";\nimport TextArea from \"../Review/TextArea\";\nimport Select from \"../Review/Select\";\nimport Button from \"../Review/Button\"; // import { withFirebase } from \"../../Firebase\";\n\n/* global google */\n// STYLES\n\nconst buttonStyle = {\n  margin: \"10px 10px 10px 10px\"\n}; // STYLED COMPONENTS\n\nconst StyleModal = styled.div(_templateObject());\nconst Header = styled.div(_templateObject2());\nconst StyledForm = styled.form(_templateObject3());\nconst NetworkTextStyle = styled.p(_templateObject4());\n\nclass ReviewPanel1 extends Component {\n  constructor(props) {\n    super(props); // STATE\n\n    this.toggleNetworkTest = () => {\n      this.setState(prevState => {\n        return _objectSpread({}, prevState, {\n          network: !prevState.network\n        });\n      });\n    };\n\n    this.state = {\n      newUser: {\n        user_id: null,\n        rating: \" \",\n        internet_rating: \" \",\n        comments: \"\",\n        location_id: null\n      },\n      rating: [\"1\", \"2\", \"3\"],\n      internet_rating: [\"1\", \"2\", \"3\"],\n      //uid: this.props.firebase.auth.currentUser.uid,\n      submitted: false,\n      network: false,\n      distanceFromLocation: 100\n    };\n    this.handleTextArea = this.handleTextArea.bind(this);\n    this.handleFormSubmit = this.handleFormSubmit.bind(this);\n    this.handleClearForm = this.handleClearForm.bind(this);\n    this.handleInput = this.handleInput.bind(this);\n  } // COMPONENT\n\n\n  componentDidMount() {\n    console.log(this.props); //Distance between user and review location, used for conditional render of button\n\n    const geocoder = new google.maps.Geocoder(); //Default to Sydney, Australia to match map default\n\n    let userCoords = [-33.856, 151.215]; //Check if user allowed location sharing\n\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        userCoords = [position.coords.latitude, position.coords.longitude];\n\n        geocoder.__proto__.geocode({\n          address: this.props.address\n        }, (res, err) => {\n          const locationCoords = [res[0].geometry.location.lat(), res[0].geometry.location.lng()];\n          this.setState(prevState => {\n            return _objectSpread({}, prevState, {\n              distanceFromLocation: distanceTo(userCoords, locationCoords)\n            });\n          });\n        });\n      });\n    }\n\n    return axiosWithAuth().get(\"https://wheretocode-master.herokuapp.com/users/\".concat(this.state.uid)).then(user => {\n      let currentUserId = {\n        user_id: user.data[0].id,\n        rating: null,\n        internet_rating: null,\n        comments: \"\"\n      };\n      this.setState({\n        newUser: currentUserId\n      });\n    }).then(res => {\n      let locationReq = this.props.locationId;\n      return axios.get(\"https://wheretocode-master.herokuapp.com/locations/\".concat(locationReq));\n    }).then(res => {\n      if (!res) {\n        let newLocation = [{\n          locationName: this.props.details[0],\n          locationGoogleId: this.props.locationId\n        }];\n        return axios.post(\"https://wheretocode-master.herokuapp.com/locations\", newLocation);\n      } else {\n        console.log(\"location does not need to be posted\");\n      }\n    }).then(res => {\n      let locationReq = this.props.locationId;\n      return axios.get(\"https://wheretocode-master.herokuapp.com/locations/\".concat(locationReq));\n    }).then(user => {\n      let currentUser = {\n        user_id: this.state.newUser.user_id,\n        rating: \"\",\n        internet_rating: \"\",\n        comments: \"\",\n        location_id: user.data[0].id\n      };\n      this.setState({\n        newUser: currentUser\n      });\n    }).catch(err => {\n      console.log(err);\n    });\n  } // METHODS\n\n\n  handleInput(e) {\n    let value = e.target.value;\n    let name = e.target.name;\n    this.setState(prevState => ({\n      newUser: _objectSpread({}, prevState.newUser, {\n        [name]: value\n      })\n    }));\n  }\n\n  handleTextArea(e) {\n    let value = e.target.value;\n    this.setState(prevState => ({\n      newUser: _objectSpread({}, prevState.newUser, {\n        comments: value\n      })\n    }));\n  }\n\n  handleFormSubmit(e) {\n    e.preventDefault();\n    let userData = this.state.newUser;\n    axiosWithAuth().post(\"https://wheretocode-master.herokuapp.com/reviews\", userData) // .post(`http://localhost:8080/reviews`, userData)\n    .then(res => {\n      this.setState({\n        submitted: true\n      });\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  handleClearForm(e) {\n    e.preventDefault();\n    this.setState({\n      newUser: {\n        user_id: \"\",\n        rating: \" \",\n        comments: \"\",\n        internet_rating: \"\"\n      }\n    });\n  }\n\n  render() {\n    return React.createElement(React.Fragment, null, this.state.submitted ? React.createElement(StyleModal, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, React.createElement(Header, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, \"Thank You For Submitting A Review\")) : React.createElement(StyleModal, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }, React.createElement(Header, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247\n      },\n      __self: this\n    }, \" Leave a Review \"), React.createElement(\"div\", {\n      style: {\n        display: \"flex\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249\n      },\n      __self: this\n    }, React.createElement(StyledForm, {\n      form: true,\n      onSubmit: this.handleFormSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }, React.createElement(Select, {\n      title: \"Location Rating\",\n      name: \"rating\",\n      options: this.state.rating,\n      value: this.state.newUser.rating,\n      placeholder: \"Select Rating\",\n      handleChange: this.handleInput,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252\n      },\n      __self: this\n    }), React.createElement(Select, {\n      title: \"Internet Rating\",\n      name: \"internet_rating\",\n      options: this.state.internet_rating,\n      value: this.state.newUser.internet_rating,\n      placeholder: \"Select Internet Rating\",\n      handleChange: this.handleInput,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261\n      },\n      __self: this\n    }), React.createElement(TextArea, {\n      title: \"Comments\",\n      rows: 10,\n      cols: 50,\n      value: this.state.newUser.comments,\n      name: \"comment\",\n      handleChange: this.handleTextArea,\n      placeholder: \"Leave a comment\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"buttonContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }, React.createElement(Button, {\n      action: this.handleFormSubmit,\n      type: \"primary\",\n      title: \"Submit\",\n      style: buttonStyle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }), React.createElement(Button, {\n      action: this.handleClearForm,\n      type: \"secondary\",\n      title: \"Clear\",\n      style: buttonStyle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }))), this.state.network ? React.createElement(NetworkSpeed, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }) : null), // Only render network test option if user is within 100ft (30.48m) of location\n    this.state.distanceFromLocation <= 30.48 ? React.createElement(NetworkModal, {\n      handleNetwork: this.toggleNetworkTest,\n      runTest: this.state.network,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }) : null, React.createElement(NetworkTextStyle, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308\n      },\n      __self: this\n    }, this.state.distanceFromLocation > 30.48 ? // Convert Meters to Miles\n    \"Must be \".concat(((this.state.distanceFromLocation - 30.48) * 0.000621).toFixed(2), \" miles closer to test network\") : null)));\n  }\n\n}\n\nconst ReviewPanel = ReviewPanel1;\nexport { ReviewPanel };","map":{"version":3,"sources":["/Users/ajohnson/Desktop/lambda/where-to-code-fe/src/components/Review/ReviewPanel.js"],"names":["React","Component","styled","axios","axiosWithAuth","NetworkModal","NetworkSpeed","TextArea","Select","Button","buttonStyle","margin","StyleModal","div","Header","StyledForm","form","NetworkTextStyle","p","ReviewPanel1","constructor","props","toggleNetworkTest","setState","prevState","network","state","newUser","user_id","rating","internet_rating","comments","location_id","submitted","distanceFromLocation","handleTextArea","bind","handleFormSubmit","handleClearForm","handleInput","componentDidMount","console","log","geocoder","google","maps","Geocoder","userCoords","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","__proto__","geocode","address","res","err","locationCoords","geometry","location","lat","lng","distanceTo","get","uid","then","user","currentUserId","data","id","locationReq","locationId","newLocation","locationName","details","locationGoogleId","post","currentUser","catch","e","value","target","name","preventDefault","userData","error","render","display","toFixed","ReviewPanel"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB,C,CACA;;AACA,OAAOC,aAAP,MAA0B,6BAA1B,C,CAEA;;AACA,OAAOC,YAAP,MAAyB,8BAAzB;AACA,OAAOC,YAAP,MAAyB,8BAAzB;AAEA,OAAOC,QAAP,MAAqB,oBAArB;AACA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,OAAOC,MAAP,MAAmB,kBAAnB,C,CACA;;AAEA;AAEA;;AACA,MAAMC,WAAW,GAAG;AAClBC,EAAAA,MAAM,EAAE;AADU,CAApB,C,CAIA;;AACA,MAAMC,UAAU,GAAGV,MAAM,CAACW,GAAV,mBAAhB;AAQA,MAAMC,MAAM,GAAGZ,MAAM,CAACW,GAAV,oBAAZ;AAQA,MAAME,UAAU,GAAGb,MAAM,CAACc,IAAV,oBAAhB;AAmBA,MAAMC,gBAAgB,GAAGf,MAAM,CAACgB,CAAV,oBAAtB;;AAOA,MAAMC,YAAN,SAA2BlB,SAA3B,CAAqC;AACnCmB,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN,EADiB,CAEjB;;AAFiB,SAoKnBC,iBApKmB,GAoKC,MAAM;AACxB,WAAKC,QAAL,CAAcC,SAAS,IAAI;AACzB,iCAAYA,SAAZ;AAAuBC,UAAAA,OAAO,EAAE,CAACD,SAAS,CAACC;AAA3C;AACD,OAFD;AAGD,KAxKkB;;AAGjB,SAAKC,KAAL,GAAa;AACXC,MAAAA,OAAO,EAAE;AACPC,QAAAA,OAAO,EAAE,IADF;AAEPC,QAAAA,MAAM,EAAE,GAFD;AAGPC,QAAAA,eAAe,EAAE,GAHV;AAIPC,QAAAA,QAAQ,EAAE,EAJH;AAKPC,QAAAA,WAAW,EAAE;AALN,OADE;AAQXH,MAAAA,MAAM,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CARG;AASXC,MAAAA,eAAe,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CATN;AAUX;AACAG,MAAAA,SAAS,EAAE,KAXA;AAYXR,MAAAA,OAAO,EAAE,KAZE;AAaXS,MAAAA,oBAAoB,EAAE;AAbX,KAAb;AAgBA,SAAKC,cAAL,GAAsB,KAAKA,cAAL,CAAoBC,IAApB,CAAyB,IAAzB,CAAtB;AACA,SAAKC,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBD,IAAtB,CAA2B,IAA3B,CAAxB;AACA,SAAKE,eAAL,GAAuB,KAAKA,eAAL,CAAqBF,IAArB,CAA0B,IAA1B,CAAvB;AACA,SAAKG,WAAL,GAAmB,KAAKA,WAAL,CAAiBH,IAAjB,CAAsB,IAAtB,CAAnB;AACD,GAxBkC,CAyBnC;;;AACAI,EAAAA,iBAAiB,GAAG;AAClBC,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKrB,KAAjB,EADkB,CAElB;;AACA,UAAMsB,QAAQ,GAAG,IAAIC,MAAM,CAACC,IAAP,CAAYC,QAAhB,EAAjB,CAHkB,CAKlB;;AACA,QAAIC,UAAU,GAAG,CAAC,CAAC,MAAF,EAAU,OAAV,CAAjB,CANkB,CAQlB;;AACA,QAAIC,SAAS,CAACC,WAAd,EAA2B;AACzBD,MAAAA,SAAS,CAACC,WAAV,CAAsBC,kBAAtB,CAAyCC,QAAQ,IAAI;AACnDJ,QAAAA,UAAU,GAAG,CAACI,QAAQ,CAACC,MAAT,CAAgBC,QAAjB,EAA2BF,QAAQ,CAACC,MAAT,CAAgBE,SAA3C,CAAb;;AAEAX,QAAAA,QAAQ,CAACY,SAAT,CAAmBC,OAAnB,CACE;AAAEC,UAAAA,OAAO,EAAE,KAAKpC,KAAL,CAAWoC;AAAtB,SADF,EAEE,CAACC,GAAD,EAAMC,GAAN,KAAc;AACZ,gBAAMC,cAAc,GAAG,CACrBF,GAAG,CAAC,CAAD,CAAH,CAAOG,QAAP,CAAgBC,QAAhB,CAAyBC,GAAzB,EADqB,EAErBL,GAAG,CAAC,CAAD,CAAH,CAAOG,QAAP,CAAgBC,QAAhB,CAAyBE,GAAzB,EAFqB,CAAvB;AAKA,eAAKzC,QAAL,CAAcC,SAAS,IAAI;AACzB,qCACKA,SADL;AAEEU,cAAAA,oBAAoB,EAAE+B,UAAU,CAAClB,UAAD,EAAaa,cAAb;AAFlC;AAID,WALD;AAMD,SAdH;AAgBD,OAnBD;AAoBD;;AAED,WAAOxD,aAAa,GACjB8D,GADI,0DACkD,KAAKxC,KAAL,CAAWyC,GAD7D,GAEJC,IAFI,CAECC,IAAI,IAAI;AACZ,UAAIC,aAAa,GAAG;AAClB1C,QAAAA,OAAO,EAAEyC,IAAI,CAACE,IAAL,CAAU,CAAV,EAAaC,EADJ;AAElB3C,QAAAA,MAAM,EAAE,IAFU;AAGlBC,QAAAA,eAAe,EAAE,IAHC;AAIlBC,QAAAA,QAAQ,EAAE;AAJQ,OAApB;AAMA,WAAKR,QAAL,CAAc;AACZI,QAAAA,OAAO,EAAE2C;AADG,OAAd;AAGD,KAZI,EAaJF,IAbI,CAaCV,GAAG,IAAI;AACX,UAAIe,WAAW,GAAG,KAAKpD,KAAL,CAAWqD,UAA7B;AACA,aAAOvE,KAAK,CAAC+D,GAAN,8DACiDO,WADjD,EAAP;AAGD,KAlBI,EAmBJL,IAnBI,CAmBCV,GAAG,IAAI;AACX,UAAI,CAACA,GAAL,EAAU;AACR,YAAIiB,WAAW,GAAG,CAChB;AACEC,UAAAA,YAAY,EAAE,KAAKvD,KAAL,CAAWwD,OAAX,CAAmB,CAAnB,CADhB;AAEEC,UAAAA,gBAAgB,EAAE,KAAKzD,KAAL,CAAWqD;AAF/B,SADgB,CAAlB;AAMA,eAAOvE,KAAK,CAAC4E,IAAN,CACL,oDADK,EAELJ,WAFK,CAAP;AAID,OAXD,MAWO;AACLlC,QAAAA,OAAO,CAACC,GAAR,CAAY,qCAAZ;AACD;AACF,KAlCI,EAmCJ0B,IAnCI,CAmCCV,GAAG,IAAI;AACX,UAAIe,WAAW,GAAG,KAAKpD,KAAL,CAAWqD,UAA7B;AACA,aAAOvE,KAAK,CAAC+D,GAAN,8DACiDO,WADjD,EAAP;AAGD,KAxCI,EAyCJL,IAzCI,CAyCCC,IAAI,IAAI;AACZ,UAAIW,WAAW,GAAG;AAChBpD,QAAAA,OAAO,EAAE,KAAKF,KAAL,CAAWC,OAAX,CAAmBC,OADZ;AAEhBC,QAAAA,MAAM,EAAE,EAFQ;AAGhBC,QAAAA,eAAe,EAAE,EAHD;AAIhBC,QAAAA,QAAQ,EAAE,EAJM;AAKhBC,QAAAA,WAAW,EAAEqC,IAAI,CAACE,IAAL,CAAU,CAAV,EAAaC;AALV,OAAlB;AAOA,WAAKjD,QAAL,CAAc;AACZI,QAAAA,OAAO,EAAEqD;AADG,OAAd;AAGD,KApDI,EAqDJC,KArDI,CAqDEtB,GAAG,IAAI;AACZlB,MAAAA,OAAO,CAACC,GAAR,CAAYiB,GAAZ;AACD,KAvDI,CAAP;AAwDD,GAlHkC,CAoHnC;;;AACApB,EAAAA,WAAW,CAAC2C,CAAD,EAAI;AACb,QAAIC,KAAK,GAAGD,CAAC,CAACE,MAAF,CAASD,KAArB;AACA,QAAIE,IAAI,GAAGH,CAAC,CAACE,MAAF,CAASC,IAApB;AAEA,SAAK9D,QAAL,CAAcC,SAAS,KAAK;AAC1BG,MAAAA,OAAO,oBACFH,SAAS,CAACG,OADR;AAEL,SAAC0D,IAAD,GAAQF;AAFH;AADmB,KAAL,CAAvB;AAMD;;AAEDhD,EAAAA,cAAc,CAAC+C,CAAD,EAAI;AAChB,QAAIC,KAAK,GAAGD,CAAC,CAACE,MAAF,CAASD,KAArB;AACA,SAAK5D,QAAL,CAAcC,SAAS,KAAK;AAC1BG,MAAAA,OAAO,oBACFH,SAAS,CAACG,OADR;AAELI,QAAAA,QAAQ,EAAEoD;AAFL;AADmB,KAAL,CAAvB;AAMD;;AAED9C,EAAAA,gBAAgB,CAAC6C,CAAD,EAAI;AAClBA,IAAAA,CAAC,CAACI,cAAF;AACA,QAAIC,QAAQ,GAAG,KAAK7D,KAAL,CAAWC,OAA1B;AACAvB,IAAAA,aAAa,GACV2E,IADH,CACQ,kDADR,EAC4DQ,QAD5D,EAEE;AAFF,KAGGnB,IAHH,CAGQV,GAAG,IAAI;AACX,WAAKnC,QAAL,CAAc;AAAEU,QAAAA,SAAS,EAAE;AAAb,OAAd;AACD,KALH,EAMGgD,KANH,CAMSO,KAAK,IAAI;AACd/C,MAAAA,OAAO,CAACC,GAAR,CAAY8C,KAAZ;AACD,KARH;AASD;;AAEDlD,EAAAA,eAAe,CAAC4C,CAAD,EAAI;AACjBA,IAAAA,CAAC,CAACI,cAAF;AACA,SAAK/D,QAAL,CAAc;AACZI,MAAAA,OAAO,EAAE;AACPC,QAAAA,OAAO,EAAE,EADF;AAEPC,QAAAA,MAAM,EAAE,GAFD;AAGPE,QAAAA,QAAQ,EAAE,EAHH;AAIPD,QAAAA,eAAe,EAAE;AAJV;AADG,KAAd;AAQD;;AAQD2D,EAAAA,MAAM,GAAG;AACP,WACE,0CACG,KAAK/D,KAAL,CAAWO,SAAX,GACC,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CADF,CADD,GAKC,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,EAGE;AAAK,MAAA,KAAK,EAAE;AAAEyD,QAAAA,OAAO,EAAE;AAAX,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,UAAD;AAAY,MAAA,IAAI,MAAhB;AAAiB,MAAA,QAAQ,EAAE,KAAKrD,gBAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEE,oBAAC,MAAD;AACE,MAAA,KAAK,EAAE,iBADT;AAEE,MAAA,IAAI,EAAE,QAFR;AAGE,MAAA,OAAO,EAAE,KAAKX,KAAL,CAAWG,MAHtB;AAIE,MAAA,KAAK,EAAE,KAAKH,KAAL,CAAWC,OAAX,CAAmBE,MAJ5B;AAKE,MAAA,WAAW,EAAE,eALf;AAME,MAAA,YAAY,EAAE,KAAKU,WANrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EAWE,oBAAC,MAAD;AACE,MAAA,KAAK,EAAE,iBADT;AAEE,MAAA,IAAI,EAAE,iBAFR;AAGE,MAAA,OAAO,EAAE,KAAKb,KAAL,CAAWI,eAHtB;AAIE,MAAA,KAAK,EAAE,KAAKJ,KAAL,CAAWC,OAAX,CAAmBG,eAJ5B;AAKE,MAAA,WAAW,EAAE,wBALf;AAME,MAAA,YAAY,EAAE,KAAKS,WANrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAXF,EAoBE,oBAAC,QAAD;AACE,MAAA,KAAK,EAAE,UADT;AAEE,MAAA,IAAI,EAAE,EAFR;AAGE,MAAA,IAAI,EAAE,EAHR;AAIE,MAAA,KAAK,EAAE,KAAKb,KAAL,CAAWC,OAAX,CAAmBI,QAJ5B;AAKE,MAAA,IAAI,EAAE,SALR;AAME,MAAA,YAAY,EAAE,KAAKI,cANrB;AAOE,MAAA,WAAW,EAAE,iBAPf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MApBF,EA8BE;AAAK,MAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,MAAD;AACE,MAAA,MAAM,EAAE,KAAKE,gBADf;AAEE,MAAA,IAAI,EAAE,SAFR;AAGE,MAAA,KAAK,EAAE,QAHT;AAIE,MAAA,KAAK,EAAE3B,WAJT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAQE,oBAAC,MAAD;AACE,MAAA,MAAM,EAAE,KAAK4B,eADf;AAEE,MAAA,IAAI,EAAE,WAFR;AAGE,MAAA,KAAK,EAAE,OAHT;AAIE,MAAA,KAAK,EAAE5B,WAJT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MARF,CA9BF,CADF,EAgDG,KAAKgB,KAAL,CAAWD,OAAX,GAAqB,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAArB,GAAwC,IAhD3C,CAHF,EAsDG;AACD,SAAKC,KAAL,CAAWQ,oBAAX,IAAmC,KAAnC,GACE,oBAAC,YAAD;AACE,MAAA,aAAa,EAAE,KAAKZ,iBADtB;AAEE,MAAA,OAAO,EAAE,KAAKI,KAAL,CAAWD,OAFtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,GAKI,IA5DN,EA8DE,oBAAC,gBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKC,KAAL,CAAWQ,oBAAX,GAAkC,KAAlC,GACG;AADH,sBAEc,CACT,CAAC,KAAKR,KAAL,CAAWQ,oBAAX,GAAkC,KAAnC,IACA,QAFS,EAGTyD,OAHS,CAGD,CAHC,CAFd,qCAMG,IAPN,CA9DF,CANJ,CADF;AAkFD;;AA9PkC;;AAiQrC,MAAMC,WAAW,GAAGzE,YAApB;AACA,SAASyE,WAAT","sourcesContent":["// IMPORTS\nimport React, { Component } from \"react\";\nimport styled from \"styled-components\";\nimport axios from \"axios\";\n//import { distanceTo } from \"geolocation-utils\";\nimport axiosWithAuth from \"../../Helpers/axiosWithAuth\";\n\n// COMPONENTS\nimport NetworkModal from \"../NetworkSpeed/networkModal\";\nimport NetworkSpeed from \"../NetworkSpeed/NetworkSpeed\";\n\nimport TextArea from \"../Review/TextArea\";\nimport Select from \"../Review/Select\";\nimport Button from \"../Review/Button\";\n// import { withFirebase } from \"../../Firebase\";\n\n/* global google */\n\n// STYLES\nconst buttonStyle = {\n  margin: \"10px 10px 10px 10px\"\n};\n\n// STYLED COMPONENTS\nconst StyleModal = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 10px;\n  font-size: 12px;\n  max-height: 550px;\n`;\nconst Header = styled.div`\n  text-align: center;\n  font-size: 20px;\n  font-weight: bold;\n  color: #fbd702;\n  width: 100%;\n  margin-bottom: 15px;\n`;\nconst StyledForm = styled.form`\n  display: flex;\n  flex-direction: column;\n  padding: 15px;\n  margin: 5px 0 5px 0;\n  font-weight: bold;\n  font-size: 14px;\n  box-shadow: 10px 6px 10px 6px rgba(0, 0, 0, 0.2);\n  .buttonContainer {\n    display: flex;\n    justify-content: center;\n  }\n  border-radius: 10px 10px 10px 10px;\n  background-color: white;\n  const buttonStyle = {\n    margin: \"10px 10px 10px 10px\";\n  }\n`;\n\nconst NetworkTextStyle = styled.p`\n  font-size: 20px;\n  color: white;\n  font-weight: 500;\n  letter-spacing: 3px;\n`;\n\nclass ReviewPanel1 extends Component {\n  constructor(props) {\n    super(props);\n    // STATE\n    this.state = {\n      newUser: {\n        user_id: null,\n        rating: \" \",\n        internet_rating: \" \",\n        comments: \"\",\n        location_id: null\n      },\n      rating: [\"1\", \"2\", \"3\"],\n      internet_rating: [\"1\", \"2\", \"3\"],\n      //uid: this.props.firebase.auth.currentUser.uid,\n      submitted: false,\n      network: false,\n      distanceFromLocation: 100\n    };\n\n    this.handleTextArea = this.handleTextArea.bind(this);\n    this.handleFormSubmit = this.handleFormSubmit.bind(this);\n    this.handleClearForm = this.handleClearForm.bind(this);\n    this.handleInput = this.handleInput.bind(this);\n  }\n  // COMPONENT\n  componentDidMount() {\n    console.log(this.props);\n    //Distance between user and review location, used for conditional render of button\n    const geocoder = new google.maps.Geocoder();\n\n    //Default to Sydney, Australia to match map default\n    let userCoords = [-33.856, 151.215];\n\n    //Check if user allowed location sharing\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        userCoords = [position.coords.latitude, position.coords.longitude];\n\n        geocoder.__proto__.geocode(\n          { address: this.props.address },\n          (res, err) => {\n            const locationCoords = [\n              res[0].geometry.location.lat(),\n              res[0].geometry.location.lng()\n            ];\n\n            this.setState(prevState => {\n              return {\n                ...prevState,\n                distanceFromLocation: distanceTo(userCoords, locationCoords)\n              };\n            });\n          }\n        );\n      });\n    }\n\n    return axiosWithAuth()\n      .get(`https://wheretocode-master.herokuapp.com/users/${this.state.uid}`)\n      .then(user => {\n        let currentUserId = {\n          user_id: user.data[0].id,\n          rating: null,\n          internet_rating: null,\n          comments: \"\"\n        };\n        this.setState({\n          newUser: currentUserId\n        });\n      })\n      .then(res => {\n        let locationReq = this.props.locationId;\n        return axios.get(\n          `https://wheretocode-master.herokuapp.com/locations/${locationReq}`\n        );\n      })\n      .then(res => {\n        if (!res) {\n          let newLocation = [\n            {\n              locationName: this.props.details[0],\n              locationGoogleId: this.props.locationId\n            }\n          ];\n          return axios.post(\n            \"https://wheretocode-master.herokuapp.com/locations\",\n            newLocation\n          );\n        } else {\n          console.log(\"location does not need to be posted\");\n        }\n      })\n      .then(res => {\n        let locationReq = this.props.locationId;\n        return axios.get(\n          `https://wheretocode-master.herokuapp.com/locations/${locationReq}`\n        );\n      })\n      .then(user => {\n        let currentUser = {\n          user_id: this.state.newUser.user_id,\n          rating: \"\",\n          internet_rating: \"\",\n          comments: \"\",\n          location_id: user.data[0].id\n        };\n        this.setState({\n          newUser: currentUser\n        });\n      })\n      .catch(err => {\n        console.log(err);\n      });\n  }\n\n  // METHODS\n  handleInput(e) {\n    let value = e.target.value;\n    let name = e.target.name;\n\n    this.setState(prevState => ({\n      newUser: {\n        ...prevState.newUser,\n        [name]: value\n      }\n    }));\n  }\n\n  handleTextArea(e) {\n    let value = e.target.value;\n    this.setState(prevState => ({\n      newUser: {\n        ...prevState.newUser,\n        comments: value\n      }\n    }));\n  }\n\n  handleFormSubmit(e) {\n    e.preventDefault();\n    let userData = this.state.newUser;\n    axiosWithAuth()\n      .post(\"https://wheretocode-master.herokuapp.com/reviews\", userData)\n      // .post(`http://localhost:8080/reviews`, userData)\n      .then(res => {\n        this.setState({ submitted: true });\n      })\n      .catch(error => {\n        console.log(error);\n      });\n  }\n\n  handleClearForm(e) {\n    e.preventDefault();\n    this.setState({\n      newUser: {\n        user_id: \"\",\n        rating: \" \",\n        comments: \"\",\n        internet_rating: \"\"\n      }\n    });\n  }\n\n  toggleNetworkTest = () => {\n    this.setState(prevState => {\n      return { ...prevState, network: !prevState.network };\n    });\n  };\n\n  render() {\n    return (\n      <>\n        {this.state.submitted ? (\n          <StyleModal>\n            <Header>Thank You For Submitting A Review</Header>\n          </StyleModal>\n        ) : (\n          <StyleModal>\n            <Header> Leave a Review </Header>\n\n            <div style={{ display: \"flex\" }}>\n              <StyledForm form onSubmit={this.handleFormSubmit}>\n                {/* Rating Required*/}\n                <Select\n                  title={\"Location Rating\"}\n                  name={\"rating\"}\n                  options={this.state.rating}\n                  value={this.state.newUser.rating}\n                  placeholder={\"Select Rating\"}\n                  handleChange={this.handleInput}\n                />\n                {/*Internet Rating */}\n                <Select\n                  title={\"Internet Rating\"}\n                  name={\"internet_rating\"}\n                  options={this.state.internet_rating}\n                  value={this.state.newUser.internet_rating}\n                  placeholder={\"Select Internet Rating\"}\n                  handleChange={this.handleInput}\n                />\n                {/*Comment */}\n                <TextArea\n                  title={\"Comments\"}\n                  rows={10}\n                  cols={50}\n                  value={this.state.newUser.comments}\n                  name={\"comment\"}\n                  handleChange={this.handleTextArea}\n                  placeholder={\"Leave a comment\"}\n                />\n                {/*Submit */}\n                <div className='buttonContainer'>\n                  <Button\n                    action={this.handleFormSubmit}\n                    type={\"primary\"}\n                    title={\"Submit\"}\n                    style={buttonStyle}\n                  />\n                  {/* Clear form */}\n                  <Button\n                    action={this.handleClearForm}\n                    type={\"secondary\"}\n                    title={\"Clear\"}\n                    style={buttonStyle}\n                  />\n                </div>\n              </StyledForm>\n\n              {this.state.network ? <NetworkSpeed /> : null}\n            </div>\n\n            {// Only render network test option if user is within 100ft (30.48m) of location\n            this.state.distanceFromLocation <= 30.48 ? (\n              <NetworkModal\n                handleNetwork={this.toggleNetworkTest}\n                runTest={this.state.network}\n              />\n            ) : null}\n\n            <NetworkTextStyle>\n              {this.state.distanceFromLocation > 30.48\n                ? // Convert Meters to Miles\n                  `Must be ${(\n                    (this.state.distanceFromLocation - 30.48) *\n                    0.000621\n                  ).toFixed(2)} miles closer to test network`\n                : null}\n            </NetworkTextStyle>\n          </StyleModal>\n        )}\n      </>\n    );\n  }\n}\n\nconst ReviewPanel = ReviewPanel1;\nexport { ReviewPanel };\n"]},"metadata":{},"sourceType":"module"}